<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Transitions</title>
    <meta name="description" content="A collection of components that make it easy to build interactive charts with D3.">

    <script src="https://d3fc.io/lib/browser.js"></script>
    <script src="https://d3fc.io/lib/custom-event-polyfill.js"></script>
    <script src="https://d3fc.io/lib/document-register-element.js"></script>
    <script src="https://d3fc.io/lib/d3.min.js"></script>
    <script src="https://d3fc.io/lib/jquery.min.js"></script>
    <script src="https://d3fc.io/lib/bootstrap.min.js"></script>
    <script src="https://d3fc.io/lib/d3fc.min.js"></script>
    <script src="https://d3fc.io/lib/d3-legend.min.js"></script>
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://d3fc.io/images/favicon-96x96.png" sizes="96x96">
    <link rel="stylesheet" href="https://d3fc.io/styles.css" />
    <link rel="canonical" href="https://d3fc.io/introduction/transitions.html" />
  </head>
  <body>
    <div class="content">

      <nav class="navbar navbar-inverse">
        <div class="container">
            <div class="navbar-header">
                <a href="https://d3fc.io/"><img class="navbar-logo" alt="d3fc" src="https://d3fc.io/images/logo.svg" /></a>
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="navbar-collapse collapse">
              <div class="floating-nav inverted">
                <ul class="nav navbar-nav">
                  <li class="active"><a href="https://d3fc.io/introduction/getting-started.html">Documentation</a></li>
                  <li class="">
                    <a href="https://d3fc.io/api/annotation-api.html">API</a>
                  </li>
                  <li><a href="https://d3fc.io/examples/">Examples</a></li>
                  <li><a href="https://github.com/d3fc/d3fc">GitHub</a></li>
                  <li class="separator"></li>
                </ul>
              </div>
            </div>
        </div>
      </nav>

      
<div class="container content">
  <div class="col-sm-9 col-xs-12">
    <h1>
      Transitions
    </h1>
    <p>D3 has built-in support for transitions allowing you to animate changes to the DOM or SVG. When combined with a data-join this feature allows you to easily animate a visualization based on changes to the underlying data.</p>
<p>The transition API is very easy to use, you simply change a selection into a transition as follows:</p>
<pre><code><span class="hljs-selector-tag">d3</span><span class="hljs-selector-class">.select</span>(<span class="hljs-string">"body"</span>)
  <span class="hljs-selector-class">.transition</span>()
  <span class="hljs-selector-class">.style</span>(<span class="hljs-string">"color"</span>, <span class="hljs-string">"red"</span>);</code></pre><p>For a detailed introduction to transitions, take a look at the <a href="https://github.com/d3/d3-transition">API documentation</a>.</p>
<p>All of the d3fc components have been implemented in order to work with transitions. What this means is that they will perform logical animations on enter, update or exit (for example bars animate upwards from the baseline on enter). In order for a series component to transition correctly you need to supply a key-function, via the <code>key</code> property, this is equivalent to the key function that you supply when performing a data-join via <a href="https://github.com/d3/d3-selection/blob/master/README.md#selection_data">selection.data</a>. The key-function is used to determine the &#39;identity&#39; of each datapoint, if the array of data that is used to render a series is re-ordered, the key-function allows the series to perform a suitable transition.</p>
<p>The following example shows transitions in action, where the code indicated below converts the selection into a transition before &#39;calling&#39; the chart component:</p>
<pre><code><span class="hljs-selector-tag">d3</span><span class="hljs-selector-class">.select</span>(<span class="hljs-string">'#transitions-chart'</span>)
    <span class="hljs-selector-class">.datum</span>(data)
    <span class="hljs-selector-class">.transition</span>()  <span class="hljs-comment">// convert the selection into a transition</span>
    <span class="hljs-selector-class">.duration</span>(<span class="hljs-number">500</span>) <span class="hljs-comment">// set the duration (you can also set the easing function)</span>
    <span class="hljs-selector-class">.call</span>(chart);</code></pre><p>The above code can be repeatedly executed, with the chart (and associated series) transitioning as the data changes.</p>
<p>Here is the complete example which animates a simple bubble sort algorithm (if the example has finished, just refresh your browser!):</p>
<style type="text/css">
.bar {
  fill: #9cf;
  stroke-width: 0;
}

.plot-area {
  background-color: white;
}

d3fc-svg svg {
  overflow: visible !important;
}

</style>

<div class="codepen-link">
  <form action="https://codepen.io/pen/define" method="POST" target="_blank">
    <input type="text" name="data" hidden="true"
      value='{
        "html":"&lt;div id&#x3D;\&quot;transitions-chart\&quot; class&#x3D;\&quot;chart\&quot;&gt; &lt;/div&gt;\n",
        "js": "// generate some random data\nvar data = d3.range(40).map(Math.random);\n\n// render a bar series via the cartesian chart component\nvar barSeries = fc.seriesSvgBar()\n    .key(function(d) { return d; })\n    .crossValue(function(_, i) { return i; })\n    .mainValue(function(d) { return d; });\n\nvar chart = fc.chartSvgCartesian(\n              d3.scaleLinear(),\n              d3.scaleLinear())\n    .xDomain([-1, data.length])\n    .plotArea(barSeries);\n\nvar index = 0;\nfunction render() {\n  if (index === data.length) {\n    return; // we\"re all done!\n  }\n\n    // perform a single iteration of the bubble sort\n  var temp;\n  for (var j = index; j > 0; j--) {\n    if (data[j] < data[j - 1]) {\n      temp = data[j];\n      data[j] = data[j - 1];\n      data[j - 1] = temp;\n    }\n  }\n  index++;\n\n  // re-render the chart\n  d3.select(\"#transitions-chart\")\n        .datum(data)\n        .transition()\n        .duration(500)\n        .call(chart);\n}\n\nsetInterval(render, 1000);\nrender();\n",
        "css": ".chart-label {\n  font-size: 1.5em;\n  line-height: normal;\n  color: black;\n}\n\n.chart {\n  margin: 10px 0;\n  width: 100%;\n  height: 250px;\n}\n\n.chart svg {\n  overflow: visible !important;\n}\n\n.chart.large {\n  height: 400px;\n}\n\n.y-axis-label {\n  white-space: nowrap;\n}\n.bar {\n  fill: #9cf;\n  stroke-width: 0;\n}\n\n.plot-area {\n  background-color: white;\n}\n\nd3fc-svg svg {\n  overflow: visible !important;\n}\n",
        "js_external": "https://code.jquery.com/jquery-3.1.1.slim.min.js;https://d3js.org/d3.v4.js;https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.18.0/d3-legend.js;https://d3fc.io/lib/d3fc.min.js"
      }'/>
    <input type="submit" class="btn btn-default" value="Codepen"/>
  </form>
</div>


<div id="transitions-chart" class="chart"> </div>

<script type="text/javascript">
// generate some random data
var data = d3.range(40).map(Math.random);

// render a bar series via the cartesian chart component
var barSeries = fc.seriesSvgBar()
    .key(function(d) { return d; })
    .crossValue(function(_, i) { return i; })
    .mainValue(function(d) { return d; });

var chart = fc.chartSvgCartesian(
              d3.scaleLinear(),
              d3.scaleLinear())
    .xDomain([-1, data.length])
    .plotArea(barSeries);

var index = 0;
function render() {
  if (index === data.length) {
    return; // we're all done!
  }

    // perform a single iteration of the bubble sort
  var temp;
  for (var j = index; j > 0; j--) {
    if (data[j] < data[j - 1]) {
      temp = data[j];
      data[j] = data[j - 1];
      data[j - 1] = temp;
    }
  }
  index++;

  // re-render the chart
  d3.select('#transitions-chart')
        .datum(data)
        .transition()
        .duration(500)
        .call(chart);
}

setInterval(render, 1000);
render();

</script>

<p>And here is the full sourcecode for this example (which is mostly the bubble-sort and associated boiler-plate code):</p>
<pre><code class="language-js"><span class="hljs-comment">// generate some random data</span>
<span class="hljs-keyword">var</span> <span class="hljs-keyword">data</span> = d3.range(<span class="hljs-number">40</span>).map(Math.random);

<span class="hljs-comment">// render a bar series via the cartesian chart component</span>
<span class="hljs-keyword">var</span> barSeries = fc.seriesSvgBar()
    .key(function(d) { <span class="hljs-keyword">return</span> d; })
    .crossValue(function(_, i) { <span class="hljs-keyword">return</span> i; })
    .mainValue(function(d) { <span class="hljs-keyword">return</span> d; });

<span class="hljs-keyword">var</span> chart = fc.chartSvgCartesian(
              d3.scaleLinear(),
              d3.scaleLinear())
    .xDomain([-<span class="hljs-number">1</span>, <span class="hljs-keyword">data</span>.length])
    .plotArea(barSeries);

<span class="hljs-keyword">var</span> index = <span class="hljs-number">0</span>;
function render() {
  <span class="hljs-keyword">if</span> (index === <span class="hljs-keyword">data</span>.length) {
    <span class="hljs-keyword">return</span>; <span class="hljs-comment">// we're all done!</span>
  }

    <span class="hljs-comment">// perform a single iteration of the bubble sort</span>
  <span class="hljs-keyword">var</span> temp;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = index; j &gt; <span class="hljs-number">0</span>; j--) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">data</span>[j] &lt; <span class="hljs-keyword">data</span>[j - <span class="hljs-number">1</span>]) {
      temp = <span class="hljs-keyword">data</span>[j];
      <span class="hljs-keyword">data</span>[j] = <span class="hljs-keyword">data</span>[j - <span class="hljs-number">1</span>];
      <span class="hljs-keyword">data</span>[j - <span class="hljs-number">1</span>] = temp;
    }
  }
  index++;

  <span class="hljs-comment">// re-render the chart</span>
  d3.select(<span class="hljs-string">'#transitions-chart'</span>)
        .datum(<span class="hljs-keyword">data</span>)
        .transition()
        .duration(<span class="hljs-number">500</span>)
        .call(chart);
}

setInterval(render, <span class="hljs-number">1000</span>);
render();
</code></pre>


    <p class="edit-page-block">Found a problem in this page? <a href="https://github.com/d3fc/d3fc/tree/master/site/src/introduction/transitions.md" target+"_blank">Submit a fix!</a></p>
  </div>

  <nav class="col-sm-3 hidden-xs nav-container">
    <ul class="nav nav-stacked fixed nav-sidebar">
          <li>
               <a href="/introduction/getting-started.html">Getting Started</a>
           </li>
          <li>
               <a href="/introduction/building-a-chart.html">Building A Chart</a>
           </li>
          <li>
               <a href="/introduction/component-design.html">Component Design</a>
           </li>
          <li>
               <a href="/introduction/decorate-pattern.html">Decorate Pattern</a>
           </li>
          <li>
               <span class="active">Transitions</span>
           </li>
    </ul>
  </nav>
</div>


    </div>
    <footer>
      <div class="container">
        <p class="muted credit text-center">Project supported by <a href="http://www.scottlogic.com">Scott Logic</a>.</p>
      </div>
    </footer>
  </body>
</html>
